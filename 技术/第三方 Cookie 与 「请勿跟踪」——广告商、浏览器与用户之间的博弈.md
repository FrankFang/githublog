# 第三方 Cookie 与 「请勿跟踪」——广告商、浏览器与用户之间的博弈

## 什么是第三方 Cookie

![图2](http://imgcache.oa.com/photos/24237/f01738fc30ecc898f15c80c5b3b39d3e.png)

除了你和我（用户和当前域名），皆是第三方。

什么是第三方cookie呢？
在访问一个网站A时，网站A算作第一方，如果网站A中引用了另一个网站X（网站X的域名与网站A的域名不同）的资源，这时这个网站X就被认为是第三方。（区分不同网站的标准是 **域名** 是否相同）

## 第三方 Cookie 的应用

在网站中使用第三方资源非常常见（如CDN），大多数据情况下，这并不会带来问题。不过有时候，我们可能希望能读写这个第三方域下的cookie，这时问题就来了。

1. 访客统计工具<br>比如我们有一个网站 **1.qq.com**，每当用户打开 **1.qq.com** 中的页面时，就会发送一个GET请求到 **helper.cn** 。这样，只需要分析 **helper.cn** 的日志，就可以了解 **1.qq.com** 的访问情况。<br>这类的工具会在Cookie中存放用户的ID，每个浏览器得到的ID都是不同的。用户访问时检查Cookie中的ID，ID相同的访问被认为来至同一个用户，否则，则是不同用户的访问。
2. 广告<br>你访问过的网站会写入一些 **第三方cookie** 在你的浏览器里，这些 cookie 会被一些广告公司（它们就是 **第三方**）用来售卖更精准的广告。<br>比如你曾上过一家汽车网站，那你到访其他网站时可能就会看到一些汽车类的广告。就好像无论你到哪个网站去这个 **广告会跟着你**。这些广告比普通广告更精准，广告主乐意为他们付钱。

## 浏览器对第三方 Cookie 的态度 

浏览器可不一定买广告商的账，能提供更好的隐私保障，才能更加讨好用户。

+ IE

默认不接受第三方 Cookie，不过采用 P3P 协议即可。（理论上讲，服务商应该在协议里真实地反映网站的信息搜集行为，若声明的隐私政策与实际行为不符，是要负法律责任的。）

+ Chrome、Firefox

默认接受。但用户可以选择不接受。

+ Safari中默认会阻止第三方cookie，如下图所示。

![图1](http://imgcache.oa.com/photos/24237/259e1ed12aecb9d807dd82844ca3862a.png)

目前想在较新版本的 Safari 上种植第三方 Cookie，必须 **让这个域在顶层窗口打开** （内嵌 iframe 是无效的）。也就是说，如果要种第三方 cookie，要么将页面先跳到这个域，写入cookie，再跳回来；要么弹出一个新窗口，写入cookie，再关闭弹窗。

不过幸好， Safari 认为相同父域名的站点不属于第三方，比如我们可以在 1.qq.com 里轻易地种下 2.qq.com 的 Cookie，想种 1.url.cn 则不行。 

## Don't Track Me

IE、Chrome 和 Firefox 为什么至今都没有禁用第三方 Cookie 呢，因为这里牵扯的利益关系太多，尤其是谷歌这个靠广告赚钱的公司。

另一方面，不是所有的用户都讨厌广告。

Don't Track Me 的思路则并不是主动阻止内容，而是让用户表态是否想看广告，同时把尊重用户隐私的责任转移到了广告方。

目前各主流浏览器都支持 Don't Track Me 功能，其具体实现是在用户访问网页时，在 HTTP 包头中添加 DNT 字段（如下图），意思是告诉服务器「我的用户说了不想被广告跟踪，你自己看着办吧！」(这给用户维权留下了证据)

![](http://imgcache.oa.com/photos/24237/7b2a5e2248573c7895213d028dbf1c15.png)

> 一个并不是主动阻止内容，而是依靠参与广告产业的企业自觉尊重用户的选择的方法，第一眼看起来似乎很难取得成功。但是美国广告产业目前正处在FTC（联邦贸易委员会）严密监管之下。FTC已经通过一个 官方文件明确表态，支持“请勿跟踪”。 来自FTC的压力应该会让这一方案被迅速广泛采用，就如之前它之敦促Adobe 简化其Flash cookies删除方法取得成功一样。



## 参考

- [当浏览器默认禁用第三方cookie](http://oldj.net/article/third-party-cookie/)
- [第一方Cookie VS 第三方Cookie](http://linux.cn/thread/4124/1/1/)
- [使用 P3P 规范让 IE 跨域接受第三方 cookie](http://www.lovelucy.info/ie-accept-third-party-cookie.html)
- [请勿跟踪](http://www.baike.com/wiki/%E8%AF%B7%E5%8B%BF%E8%B7%9F%E8%B8%AA)